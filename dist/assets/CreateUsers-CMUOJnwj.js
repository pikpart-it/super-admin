import{p as C,u as z,r as p,e as Y,j as r,F as f,v as Z,a as E,B as D,g as w,b as ee,c as ne,d as k}from"./index-CNrDbV-I.js";import{F as b,M as B}from"./Form-B-lxHQGT.js";import{P as se,L as re,M as le}from"./AddBUForm-D6NTCOrL.js";import"./switchClasses-DtNR1dbl.js";C.div`
  width: 80%;
  margin: auto;
`;C.div`
  width: 100%;
  padding: 10px;
`;const g=C.div`
  width: 25%;
  margin: 10px;
`,pe=()=>{var A,R,N,T,F,M,U;const S=z(),s=(R=(A=z())==null?void 0:A.location)==null?void 0:R.state,[L,W]=p.useState(!1),[c,$]=p.useState([]),[m,H]=p.useState([]),[x,q]=p.useState([]),[v,G]=p.useState([]),[i,a]=p.useState({error:!1,msg:"",isLoading:!1}),[e,I]=p.useState({first_name:"",last_name:"",email:"",phone_number:"",password:"",role_type:{roleName:"",id:0},rank:{rankCode:"",rankId:0,rankType:""},id:void 0}),J=async()=>{let n=`${k.baseUrl}/superAdmin/appRoleMasters`;try{const{data:l}=await w(n);G(l==null?void 0:l.data)}catch{}},y=n=>{I({...e,[n==null?void 0:n.name]:n==null?void 0:n.value})},K=async()=>{let n=`${k.baseUrl}/utilities/roleMasters`;try{const{data:l}=await w(n);$(l==null?void 0:l.data)}catch{}},O=async()=>{var l;let n=`${k.baseUrl}/superAdmin/userRanks`;try{const t=await w(n);q((l=t==null?void 0:t.data)==null?void 0:l.data)}catch(t){console.log(t)}};console.log({customerData:e});const Q=async()=>{var h,u,_;a({...i,isLoading:!0});let n=`${k.baseUrl}/superAdmin/updateAdminUserRole`;const l=(h=x==null?void 0:x.find(o=>{var j;return(o==null?void 0:o.id)===((j=e==null?void 0:e.rank)==null?void 0:j.rankId)}))==null?void 0:h.rankType,t={role_id:(u=e==null?void 0:e.role_type)==null?void 0:u.id,user_id:e==null?void 0:e.id,rank_id:(_=e==null?void 0:e.rank)==null?void 0:_.rankId,rank_type:l};try{const{data:o}=await ee(n,t);a({...i,isLoading:!1,error:o==null?void 0:o.error,msg:o==null?void 0:o.message}),setTimeout(()=>{a({...i,msg:""}),S.goBack()},3e3)}catch{a({...i,isLoading:!1,error:!0,msg:"Something Went Wrong!"}),setTimeout(()=>{a({...i,msg:""})},3e3)}},V=async()=>{var h,u,_,o,j;a({...i,isLoading:!0});let n=`${k.baseUrl}/auth/registerAdmin`;const l=(h=x==null?void 0:x.find(d=>{var P;return(d==null?void 0:d.id)===((P=e==null?void 0:e.rank)==null?void 0:P.rankId)}))==null?void 0:h.rankType,t={...e,resource_type:(u=e==null?void 0:e.role_type)==null?void 0:u.roleName,role_id:(_=e==null?void 0:e.role_type)==null?void 0:_.id,role_type:(o=e==null?void 0:e.role_type)==null?void 0:o.roleName,rank_id:(j=e==null?void 0:e.rank)==null?void 0:j.rankId,rank_type:l};try{const{data:d}=await ne(n,t);a({...i,isLoading:!1,error:d==null?void 0:d.error,msg:d==null?void 0:d.message}),setTimeout(()=>{a({...i,msg:""}),S.goBack()},3e3)}catch{a({...i,isLoading:!1,error:!0,msg:"Something Went Wrong!"}),setTimeout(()=>{a({...i,msg:""})},3e3)}},X=Y({...e,role_type:(N=e==null?void 0:e.role_type)==null?void 0:N.roleName,rank:(T=e==null?void 0:e.rank)==null?void 0:T.rankId,id:"t"});return p.useEffect(()=>{K(),J()},[]),p.useEffect(()=>{s!=null&&s.id&&I({...e,id:s==null?void 0:s.id,first_name:s==null?void 0:s.firstName,last_name:s==null?void 0:s.lastName,email:s==null?void 0:s.email,phone_number:s==null?void 0:s.phoneNumber,role_type:c==null?void 0:c.find(n=>(n==null?void 0:n.id)===(s==null?void 0:s.roleId)),rank:m==null?void 0:m.find(n=>(n==null?void 0:n.rankId)===(s==null?void 0:s.rankId))})},[s,c,m]),p.useEffect(()=>{var n;if((n=e==null?void 0:e.role_type)!=null&&n.id){const l=v==null?void 0:v.filter(t=>{var h;return(t==null?void 0:t.roleId)===((h=e==null?void 0:e.role_type)==null?void 0:h.id)});H(l)}},[e==null?void 0:e.role_type]),p.useEffect(()=>{setTimeout(()=>{O()},2e3)},[]),r.jsxs("div",{style:{width:"90%",margin:"auto"},children:[r.jsx(f,{justifyContentCenter:!0,style:{marginTop:"1rem"},children:r.jsx("div",{style:{fontSize:"1.3rem",color:"#f65000"},children:"Register Users"})}),r.jsxs(se,{style:{background:"#fbfbfb",padding:"20px"},children:[r.jsxs(f,{alignItemsCenter:!0,margin:"auto",wrap:!0,width:"100%",justifyContentSpaceBetween:!0,children:[r.jsx(g,{children:r.jsx(b,{type:"text",name:"first_name",value:e==null?void 0:e.first_name,onChange:n=>y(n),fieldErrors:{},label:"First Name *"})}),r.jsx(g,{children:r.jsx(b,{type:"text",name:"last_name",value:e==null?void 0:e.last_name,onChange:n=>y(n),fieldErrors:{},label:"Last Name *"})}),r.jsx(g,{children:r.jsx(B,{list:[],options:c,name:"role_type",value:e==null?void 0:e.role_type,onChange:n=>y(n),fieldErrors:{},label:"Role Type *"})}),r.jsx(g,{children:r.jsx(B,{list:[],options:m,name:"rank",value:e==null?void 0:e.rank,onChange:n=>y(n),fieldErrors:{},label:"Rank *",optionLabel:"rankCode"})}),r.jsxs(g,{children:[r.jsx(b,{type:"text",name:"email",value:e==null?void 0:e.email,onChange:n=>y(n),fieldErrors:{},label:"Email *"}),((F=e==null?void 0:e.email)==null?void 0:F.length)>0&&!Z(e==null?void 0:e.email)&&r.jsx("p",{style:{color:"red",textAlign:"center"},children:"Invalid Email!!"})]}),r.jsxs(g,{children:[r.jsx(b,{type:"text",name:"phone_number",value:e==null?void 0:e.phone_number,onChange:n=>y(n),fieldErrors:{},label:"Phone Number *",maxLength:10}),((M=e==null?void 0:e.phone_number)==null?void 0:M.length)>0&&((U=e==null?void 0:e.phone_number)==null?void 0:U.length)<10&&r.jsx("p",{style:{color:"red",textAlign:"center"},children:"Invalid phone Number!!"})]}),!(s!=null&&s.id)&&r.jsx(g,{children:r.jsxs(f,{justifyContentCenter:!0,width:"100%",children:[r.jsx(b,{type:L?"text":"password",name:"password",value:e==null?void 0:e.password,onChange:n=>y(n),fieldErrors:{},label:"Password *"}),r.jsx("div",{style:{margin:"auto 5px",fontSize:"18px",cursor:"pointer"},onClick:()=>W(!L),children:r.jsx(E,{})})]})}),r.jsx(g,{children:null})]}),r.jsx(f,{justifyContentFlexEnd:!0,width:"80%",children:r.jsxs(D,{variant:"contained",color:"success",onClick:s!=null&&s.id?Q:V,disabled:s!=null&&s.id?!1:X,children:["Submit"," "]})})]}),r.jsx(re,{variant:"m",isLoading:i.isLoading}),r.jsx(le,{style:{container:{width:"22%"}},msg:i==null?void 0:i.msg,variant:i!=null&&i.error?"danger":"success",ghost:!0,card:!0})]})};export{pe as default};
